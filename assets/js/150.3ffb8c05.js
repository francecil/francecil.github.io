(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{887:function(s,a,e){"use strict";e.r(a);var n=e(29),r=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("对于 NodeJS 项目中，我们经常需要变更 package.json 中的版本信息。")]),s._v(" "),a("p",[s._v("正常操作是，手动修改 package.json 文件的版本信息，然后再commit。")]),s._v(" "),a("p",[s._v("每次这样做，操作太繁琐。")]),s._v(" "),a("p",[s._v("实际上，我们可以使用 "),a("code",[s._v("npm version <newversion>")]),s._v(" 命令")]),s._v(" "),a("h2",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("newversion"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" major "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" minor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" patch "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" premajor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" preminor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" prepatch "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" prerelease "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" from-git"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("major: 主版本号 1.0.0->2.0.0")]),s._v(" "),a("li",[s._v("minor: 次版本号 1.0.0->1.1.0")]),s._v(" "),a("li",[s._v("patch: 补丁号 1.0.0->1.0.1 / 1.0.0-2->1.0.0 (预备版本转正式版本)")])]),s._v(" "),a("p",[s._v("发布预备版本，大致同上，只是会在版本号后加 -0 说明这个新版本是个预备版本")]),s._v(" "),a("ul",[a("li",[s._v("premajor: 预备主版本 2.2.2-1 -> 3.0.0-0")]),s._v(" "),a("li",[s._v("preminor: 预备次版本 2.2.2-1 -> 2.3.0-0")]),s._v(" "),a("li",[s._v("prepatch: 预备补丁版本 2.2.2-1 -> 2.2.3-0\n"),a("blockquote",[a("p",[s._v("如果不想要 "),a("code",[s._v("-0")]),s._v(" ，需要手动指定版本号 "),a("code",[s._v("npm version 2.2.3")])])])]),s._v(" "),a("li",[s._v("prerelease: 预发布版本 2.2.2 -> 2.2.3-0 / 2.2.3-0 -> 2.2.3-1\n"),a("blockquote",[a("p",[s._v("如果想要 2.2.2 -> 2.2.2-1 ，即预备版本作为 bugfix 用，需要手动指定版本号 "),a("code",[s._v("npm version 2.2.2-1")])])])])]),s._v(" "),a("h2",{attrs:{id:"version-命令具体做了什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#version-命令具体做了什么"}},[s._v("#")]),s._v(" version 命令具体做了什么？")]),s._v(" "),a("p",[s._v("比如当前版本为 0.1.1，使用"),a("code",[s._v("npm version patch")]),s._v("后，会执行以下操作：")]),s._v(" "),a("ol",[a("li",[s._v("修改 package.json 的 version 为0.1.2")]),s._v(" "),a("li",[s._v('git commit -m "0.1.2"')]),s._v(" "),a("li",[s._v("git tag -a v0.1.2")])]),s._v(" "),a("p",[s._v("也可以指定 commit的信息")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version patch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Upgrade to v%s"')]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# %s 会自动替换成版本号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时提交信息为： Upgrade to v0.1.2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("注：使用 "),a("code",[s._v("npm version <newversion>")]),s._v(" 命令，需要当前工作区为clean状态，否则会执行失败。")]),s._v(" "),a("h2",{attrs:{id:"最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[s._v("#")]),s._v(" 最佳实践")]),s._v(" "),a("p",[s._v("补丁号版本作为正常版本，预备版本作为 bugfix")]),s._v(" "),a("p",[s._v("同时次版本和补丁版本的版本号从 0 开始，且不超过 10")]),s._v(" "),a("p",[s._v("也就是说，正常项目发版可能是")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1.0.0 (npm version patch)->\n1.0.1 (new verison) (npm version 1.0.1-1)->\n1.0.1-1 (bugfix version) (npm version prerelease)->\n1.0.1-2 (bugfix version) (npm version 1.0.2)->\n1.0.2 (new verison)\n...\n1.0.9 (只到 x.x.9 版本) (npm version minor)->\n1.1.0 \n...\n1.9.0 (只到 x.9.x 版本) (npm version major)->\n2.0.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("p",[s._v("https://www.jianshu.com/p/9e64bdf1e8f9")])])}),[],!1,null,null,null);a.default=r.exports}}]);