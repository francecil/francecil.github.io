(window.webpackJsonp=window.webpackJsonp||[]).push([[596],{1399:function(t,a,r){"use strict";r.r(a);var e=r(30),s=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("vuepress 的内置搜索只会为页面的标题、h2 、 h3 以及 tags 构建搜索索引，无法达到全文搜索，详见 "),a("a",{attrs:{href:"https://v1.vuepress.vuejs.org/zh/theme/default-theme-config.html#%E5%86%85%E7%BD%AE%E6%90%9C%E7%B4%A2",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress 内置搜索"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("如果想全文搜索，有以下方案")]),t._v(" "),a("ul",[a("li",[t._v("Algolia: 第三方免费搜索服务；定期抓取博客内容（24h），也可以手动触发抓取。本博客目前采用方案")]),t._v(" "),a("li",[t._v("meilisearch: 基于 Algolia 开发的搜索服务，支持将博客主动部署到云服务进行搜索分词；免费版每个月 10k 的搜索限制")]),t._v(" "),a("li",[t._v("fulltext-sarch: 基于 flexsearch 方案，纯本地搜索。缺点是增加打包产物体积，可能会影响首屏")]),t._v(" "),a("li",[t._v("thirdparty-search: 第三方搜索，点击后跳转引擎搜索页面，没啥用")])]),t._v(" "),a("h2",{attrs:{id:"algolia-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#algolia-使用"}},[t._v("#")]),t._v(" Algolia 使用")]),t._v(" "),a("h3",{attrs:{id:"流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程"}},[t._v("#")]),t._v(" 流程")]),t._v(" "),a("ol",[a("li",[t._v("申请注册："),a("a",{attrs:{href:"https://docsearch.algolia.com/apply/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docsearch.algolia.com/apply/"),a("OutboundLink")],1),t._v("，可能要等一段时间。我这里是申请了多次，前面几次都没回复，最后一次申请隔天就回复了。")]),t._v(" "),a("li",[t._v("申请成功后，可以按 vuepress 的文案配置 "),a("a",{attrs:{href:"https://v1.vuepress.vuejs.org/zh/theme/default-theme-config.html#algolia-%E6%90%9C%E7%B4%A2",target:"_blank",rel:"noopener noreferrer"}},[t._v("Algolia 搜索"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("具体值可以看邮件或者平台，本博客的配置如下")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("themeConfig")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("algolia")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("apiKey")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'9697875d39432384a444b570563811be'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("indexName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gahing'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("appId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0QTGLFRP72'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("blockquote",[a("p",[t._v("PS：此配置对外暴露无风险")])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("之后在搜索框搜索即可")])]),t._v(" "),a("h3",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),a("p",[t._v("如果开始搜索后发现数据始终返回空，那么此时就需要怀疑下是不是爬虫配置有问题了。")]),t._v(" "),a("p",[t._v("首先进到"),a("a",{attrs:{href:"https://crawler.algolia.com/admin/crawlers",target:"_blank",rel:"noopener noreferrer"}},[t._v("爬虫配置页"),a("OutboundLink")],1),t._v(" ，点击相应项目，观察 Overview")]),t._v(" "),a("p",[t._v("如果 Monitoring（爬取的页面） 有数据而 Indices （页面记录）没有数据,则说明爬虫配置有问题，比如下图\n"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/francecil/cdn-resouce/uploads/algolia-records-empty.png",alt:""}})]),t._v(" "),a("p",[t._v("点击 Editor 面板进入爬虫配置。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/francecil/cdn-resouce/uploads/algolia-crawler-error.png",alt:""}})]),t._v(" "),a("p",[t._v("这里 pathsToMatch 默认是 https://域名/docs/**，但由于我的页面地不是这个路径，故会提取错误。")]),t._v(" "),a("p",[t._v("对于我的项目，我改成了 "),a("code",[t._v("https://域名/**")]),t._v(" ，然后点击右侧的 "),a("code",[t._v("Run Test")]),t._v(" 进行测试，预期应该看到 records 输出，没问题后 save ，并回到 Overview 面板执行 "),a("code",[t._v("Restart crawling")])]),t._v(" "),a("p",[t._v("等待一段时间后会发现 Records 有数据了，此时搜索可以正常使用")]),t._v(" "),a("h2",{attrs:{id:"后续优化方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后续优化方案"}},[t._v("#")]),t._v(" 后续优化方案")]),t._v(" "),a("p",[t._v("优化 fulltext-sarch 本地搜索方式，需要将资源进行异步加载")]),t._v(" "),a("h1",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://wiki.eryajf.net/pages/dfc792/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vuepress全文搜索终极版-algolia的开源实现meilisearch全接入指南"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/mqyqingfeng/Blog/issues/267",target:"_blank",rel:"noopener noreferrer"}},[t._v("VuePress 博客优化之开启 Algolia 全文搜索"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=s.exports}}]);