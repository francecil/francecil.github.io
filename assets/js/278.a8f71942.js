(window.webpackJsonp=window.webpackJsonp||[]).push([[278],{1032:function(s,a,n){"use strict";n.r(a);var t=n(27),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("本来写的是最新版3.0的 但是遇到太多坑，编译老错 换老版本的2.6")]),s._v(" "),a("h2",{attrs:{id:"配置java环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置java环境"}},[s._v("#")]),s._v(" 配置Java环境")]),s._v(" "),a("p",[a("strong",[s._v("如果只是编译ffmpeg 该步骤非必要，仅是做个记录")]),s._v("\n从"),a("a",{attrs:{href:"http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html"),a("OutboundLink")],1),s._v("下载jdk8")]),s._v(" "),a("p",[s._v("下载完文件默认在 "),a("code",[s._v("~/Downloads")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    ~# cd Downloads\n    ~/Downloads# sudo mkdir /usr/java       //创建目录用于存放\n    ~/Downloads# sudo tar zxvf jdk-8u91-linux-x64.tar.gz -C /usr/java //解压\n    ~/Downloads# cd /usr/java/\n    /usr/java# sudo mv jdk-8u91-linux-x64  jdk8  //改名,后面配置就比较方便\n    /usr/java# sudo gedit /etc/environment\n    //如果发现错误，可能是gedit的命令(usr/bin)没添加到系统环境下\n    //如果不能访问 就chmod 777 /etc/environment  \n    //并且在environment中配置的只有root用户有效 且关闭终端后无效因此配置在/etc/profile最好\n    //再这里我们可以用gedit的全路径 也可以用vim\n    // 先按照\n    sudo apt-get install vim\n    /usr/java# sudo vim /etc/profile\n    //vim命令：dd删除一样 yy复制一行 p粘贴 在environment中加入\n     export JAVA_HOME=/usr/java/jdk8\n     export JRE_HOME=/usr/java/jdk8/jre\n     export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH\n     export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH\n     > ubuntu启动后 先加载environment再加载profile\n     //注意 要按顺序写 比如JAVA_HOME写在后面 PATH的$JAVA_HOME就是空了\n     //:wq 保存退出\n     注意 要重启。且注意这边配置要小心 否则会开不了机\n     java -version 查看jdk版本 输出信息则成功\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"配置android-linux-ndk以及sdk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置android-linux-ndk以及sdk"}},[s._v("#")]),s._v(" 配置android linux NDK以及SDK")]),s._v(" "),a("p",[s._v("如果只是编译ffmpeg 只要下载sdk ndk并配置环境就可以")]),s._v(" "),a("h3",{attrs:{id:"android-studio-2-1-download"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#android-studio-2-1-download"}},[s._v("#")]),s._v(" Android studio 2.1 download")]),s._v(" "),a("p",[s._v("参考："),a("a",{attrs:{href:"https://developer.android.com/studio/install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://developer.android.com/studio/install.html"),a("OutboundLink")],1),s._v("\n下载"),a("code",[s._v("android studio 2.1")]),s._v(" "),a("a",{attrs:{href:"https://developer.android.com/studio/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://developer.android.com/studio/index.html"),a("OutboundLink")],1),s._v(" (拖到下面有各种版本)")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("/usr# sudo mkdir android\n~/Downloads# unzip xxx.zip -d /usr/android 将xxx文件解压到android目录下\n")])])]),a("p",[a("code",[s._v("Note")]),s._v(": If you are running "),a("code",[s._v("a 64-bit version of Ubuntu")]),s._v(", you need to install some 32-bit libraries with the following command:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("sudo apt-get install lib32z1 lib32ncurses5 lib32bz2-1.0 lib32stdc++6\n")])])]),a("p",[s._v("利用"),a("code",[s._v("/bin/studio.sh")]),s._v("可以启动"),a("code",[s._v("android-studio")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("Tip: Add android-studio/bin/ to your PATH environment variable so you can start Android Studio from any directory.\n")])])]),a("p",[s._v("运行"),a("code",[s._v("studio.sh")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("`error:`unable to detect graphics environment\nxdg_runtime_dir not set in the environment\n\n参考 http://www.cnblogs.com/gaodong/p/3463152.html\n加上 `export DISPLAY=:0.0`\n")])])]),a("p",[s._v("切换到界面窗口\n按步骤安装 可以选择之前下好的sdk")]),s._v(" "),a("p",[s._v("然后创建 helloworld项目 运行..（话说，真是卡。。）")]),s._v(" "),a("p",[s._v("还是用命令吧..")]),s._v(" "),a("h3",{attrs:{id:"配置-sdk-ndk-环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-sdk-ndk-环境变量"}},[s._v("#")]),s._v(" 配置 sdk ndk 环境变量")]),s._v(" "),a("p",[s._v("sdk下载https://developer.android.com/studio/index.html 下方\nndk下载https://developer.android.com/ndk/downloads/index.html")]),s._v(" "),a("p",[s._v("类似配置："),a("code",[s._v("PATH=$PATH:/home/android_sdk/tools:/home/android_sdk/ndk")])]),s._v(" "),a("h2",{attrs:{id:"从ffmpeg官网下载ffmpeg源码包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从ffmpeg官网下载ffmpeg源码包"}},[s._v("#")]),s._v(" 从ffmpeg官网下载ffmpeg源码包")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://git.ffmpeg.org/ffmpeg.git ffmpeg\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 没安装git的先安装")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"修改-ffmpeg-configure-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-ffmpeg-configure-文件"}},[s._v("#")]),s._v(" 修改 ffmpeg/configure 文件")]),s._v(" "),a("p",[s._v("将该文件")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("SLIBNAME_WITH_MAJOR='$(SLIBNAME).$(LIBMAJOR)'\nLIB_INSTALL_EXTRA_CMD='$$(RANLIB)\"$(LIBDIR)/$(LIBNAME)\"'\nSLIB_INSTALL_NAME='$(SLIBNAME_WITH_VERSION)'\nSLIB_INSTALL_LINKS='$(SLIBNAME_WITH_MAJOR)$(SLIBNAME)'\n")])])]),a("p",[s._v("修改为：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("SLIBNAME_WITH_MAJOR='$(SLIBPREF)$(FULLNAME)-$(LIBMAJOR)$(SLIBSUF)'\nLIB_INSTALL_EXTRA_CMD='$$(RANLIB)\"$(LIBDIR)/$(LIBNAME)\"'\nSLIB_INSTALL_NAME='$(SLIBNAME_WITH_MAJOR)'\nSLIB_INSTALL_LINKS='$(SLIBNAME)'\n")])])]),a("p",[s._v("这样编译出来的so命名才符合android的使用")]),s._v(" "),a("p",[s._v("接下来这些参考：https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu")]),s._v(" "),a("h2",{attrs:{id:"安装类库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装类库"}},[s._v("#")]),s._v(" 安装类库")]),s._v(" "),a("h3",{attrs:{id:"安装基本的工具类库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装基本的工具类库"}},[s._v("#")]),s._v(" 安装基本的工具类库")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" build-essential checkinstall "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" libfaac-dev libjack-jackd2-dev   libmp3lame-dev libopencore-amrnb-dev libopencore-amrwb-dev libsdl1.2-dev libtheora-dev    libva-dev libvdpau-dev libvorbis-dev libx11-dev libxfixes-dev texi2html zlib1g-dev       libssl1.0.0 libssl-dev libxvidcore-dev libxvidcore4 libass-dev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"yasm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yasm"}},[s._v("#")]),s._v(" Yasm")]),s._v(" "),a("p",[s._v("一个汇编程序被推荐用于x264 和 ffmpeg (只要解码不知道这样要不要装 蛮装了\n如果 库中 yasm package ≥ 1.2.0 可以这样")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" yasm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("否则只能")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/ffmpeg_sources\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzvf yasm-1.3.0.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" yasm-1.3.0\n./configure "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v('/ffmpeg_build"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--bindir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v('/bin"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" distclean\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"libx264"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#libx264"}},[s._v("#")]),s._v(" libx264")]),s._v(" "),a("p",[s._v("更多的详见https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu\n我只需要解码的 这边我就不需要安装了")]),s._v(" "),a("h3",{attrs:{id:"librtmp的支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#librtmp的支持"}},[s._v("#")]),s._v(" librtmp的支持")]),s._v(" "),a("p",[s._v("自带的rtmp只能支持播放非直播的 "),a("code",[s._v("rtmp(live !=1)")]),s._v("，而添加 librtmp 之后是可以播放直播的视频 并支持多种格式(rtmp://, rtmpt://, rtmpe://, rtmpte://,以及 rtmps://协议)")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/src\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone git://git.ffmpeg.org/rtmpdump\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" rtmpdump\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SYS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("posix\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" checkinstall "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--pkgname")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtmpdump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--pkgversion")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2:'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d%H%M"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('-git"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--backup")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--deldoc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--fstrans")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--default")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"编译脚本和配置选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译脚本和配置选项"}},[s._v("#")]),s._v(" 编译脚本和配置选项")]),s._v(" "),a("p",[s._v("参考https://github.com/dxjia/ffmpeg-compile-shared-library-for-android")]),s._v(" "),a("ol",[a("li",[s._v("指定临时目录")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TMPDIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/gahing/tmpdir\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("指定NDK路径")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("NDK=/home/Downloads/android-linux-sdk/android-ndk-r12b\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("指定使用NDK Platform版本")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SYSROOT=$NDK/platforms/android-16/arch-arm/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("一定要选择比你的目标机器使用的版本低的")]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[s._v("指定编译工具链")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("TOOLCHAIN=$ND\nK/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("指定编译后的安装目录")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PREFIX=/home/gahing/ffmpeg_shared_compile/arm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例脚本1 支持所有的编解码器 arm版本")]),s._v(" "),a("p",[s._v('#!/bin/bash\nexport TMPDIR=/home/gahing/tmpdir\nPREFIX=$HOME/ffmpeg_shared_compile/\nNDK=/home/gahing/Downloads/android-sdk-linux/android-ndk-r12b\nSYSROOT=$NDK/platforms/android-16/arch-arm/\nTOOLCHAIN=$NDK/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64\nCPU=arm\nADDI_CFLAGS="-marm"\nfunction build_one\n{\n./configure '),a("br"),s._v("\n--prefix=$PREFIX "),a("br"),s._v("\n--enable-shared "),a("br"),s._v("\n--disable-static "),a("br"),s._v("\n--disable-doc "),a("br"),s._v("\n--disable-ffmpeg "),a("br"),s._v("\n--disable-ffplay "),a("br"),s._v("\n--disable-ffprobe "),a("br"),s._v("\n--disable-ffserver "),a("br"),s._v("\n--disable-doc "),a("br"),s._v("\n--disable-symver "),a("br"),s._v("\n--enable-small "),a("br"),s._v("\n--cross-prefix=$TOOLCHAIN/bin/arm-linux-androideabi- "),a("br"),s._v("\n--target-os=linux "),a("br"),s._v("\n--arch=arm "),a("br"),s._v("\n--enable-cross-compile "),a("br"),s._v("\n--sysroot=$SYSROOT "),a("br"),s._v('\n--extra-cflags="-Os -fpic $ADDI_CFLAGS" '),a("br"),s._v('\n--extra-ldflags="$ADDI_LDFLAGS" '),a("br"),s._v("\n$ADDITIONAL_CONFIGURE_FLAG\nmake clean\nmake\nmake install\n}\nbuild_one")]),s._v(" "),a("p",[s._v("so的全部文件大概8~9M")]),s._v(" "),a("p",[s._v("示例脚本2 本章题目的要求（该脚本有问题 待解救）")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" clean\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TMPDIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/gahing/tmpdir\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PREFIX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/ffmpeg_shared_compile/\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NDK")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/gahing/Downloads/android-sdk-linux/android-ndk-r12b\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SYSROOT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NDK")]),s._v("/platforms/android-16/arch-arm/\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOOLCHAIN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NDK")]),s._v("/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CPU")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("arm\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADDI_CFLAGS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-marm"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("build_one")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n./configure "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PREFIX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-shared "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-static "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-avdevice "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-avfilter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-network "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-encoders "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-doc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-ffmpeg "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-ffplay "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-ffprobe "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-ffserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-doc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-symver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-muxers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-demuxers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-debug  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-yasm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-parsers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-decoders "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--disable-everything "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-nonfree "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-gpl  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-postproc  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-vdpau "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-librtmp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-decoder"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("h264 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-decoder"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("aac  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-decoder"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("h264_vdpau"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-parser"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("aac "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-parser"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("h264 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-protocol"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtmp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-small "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--cross-prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TOOLCHAIN")]),s._v("/bin/arm-linux-androideabi- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--target-os"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--arch")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("arm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--enable-cross-compile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--sysroot")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SYSROOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--extra-cflags"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Os -fpic '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDI_CFLAGS")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--extra-ldflags"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDI_LDFLAGS")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADDITIONAL_CONFIGURE_FLAG")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  \n  \nbuild_one  \n  \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("生成so")])]),s._v(" "),a("p",[s._v("运行脚本后 "),a("code",[s._v("$PREFIX")]),s._v(" 目录下生成 include和lib两个文件夹，将lib文件夹中的 pkgconfig 目录和so的链接文件删除，只保留so文件，然后将include 和lib两个目录一起copy到你的apk jni下去编译")]),s._v(" "),a("p",[s._v("之后可以参考\n"),a("a",{attrs:{href:"http://blog.csdn.net/leixiaohua1020/article/details/47008825",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://blog.csdn.net/leixiaohua1020/article/details/47008825"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("eclipse下编写jni参考"),a("a",{attrs:{href:"http://www.cnblogs.com/skyseraph/p/3979238.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.cnblogs.com/skyseraph/p/3979238.html"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);