(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{422:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"æ•…äº‹æ˜¯è¿™æ ·çš„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ•…äº‹æ˜¯è¿™æ ·çš„"}},[s._v("#")]),s._v(" æ•…äº‹æ˜¯è¿™æ ·çš„")]),s._v(" "),t("p",[s._v("å°éƒ‘æ˜¯æŸå¹³å°ä¸€ä½ UP ğŸ·ï¼Œç»è¿‡ä¸¤å¹´åŠªåŠ›ç°åœ¨å¹³å°ç²‰ä¸ä¹Ÿæœ‰ 994500 ä¸ªäº†ï¼Œè·ç¦»å†²å‡»ç™¾ä¸‡ UP ä»…å‰©ä¸€æ­¥ä¹‹é¥ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/9277731-4c8db063ccdf1ca1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"99.45w"}})]),s._v(" "),t("p",[s._v("é‡‘ä¸»çˆ¸çˆ¸å‘Šè¯‰ä»–ï¼Œåªè¦ç™¾ä¸‡ï¼Œå°±è®©ä»–æ¥ä¸ªå¤§çš„å¹¿å‘Šå•ã€‚")]),s._v(" "),t("p",[s._v("å¥ˆä½•æœ€è¿‘æ²¡æœ‰çµæ„Ÿï¼Œå¤©å¤©ğŸ•Šï¼Œå§‹ç»ˆä¸æ¶¨ç²‰ã€‚")]),s._v(" "),t("p",[s._v("äºæ˜¯ä»–ä¾¿æ‰“èµ·äº†æ­ªä¸»æ„ï¼Œä¹°ç²‰ï¼å…ˆåˆ°æŸå®ä¸Šä¹°äº† 1 åƒç²‰ä¸è¯•è¯•æ°´ï¼Œå¾ˆå¿«ï¼Œå¯¹æ–¹è¯´å·²åˆ°è´¦ã€‚")]),s._v(" "),t("p",[s._v("å°éƒ‘å…´å†²å†²çš„ä¸Šå¹³å°ä¸Šä¸€çœ‹ï¼Œå¹¶æ²¡æœ‰ï¼Œè¿˜æ˜¯æ˜¾ç¤ºçš„ "),t("code",[s._v("99.5")]),s._v(" ï¼Œ1 åƒä¸ªç²‰ä¸å»å“ªäº†ï¼Ÿï¼Ÿ")]),s._v(" "),t("p",[s._v("æ­£å‡†å¤‡æŠ•è¯‰å•†å®¶æ—¶ï¼Œé¼ æ ‡ä¸‹æ»‘çœ‹åˆ°äº†è¿™æ ·çš„ä¸€å¹•ï¼")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/9277731-4790996ca7d0b42f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"99.55w"}})]),s._v(" "),t("p",[s._v("å…·ä½“ç²‰ä¸æ•°ç¡®å®æ˜¯æ­£ç¡®çš„ï¼ŒæŒ‰ç…§å°å­¦æ•™çš„çš„å››èˆäº”å…¥ï¼Œåº”è¯¥æ˜¾ç¤º "),t("code",[s._v("99.6ä¸‡")]),s._v(" æ‰å¯¹ã€‚")]),s._v(" "),t("p",[s._v("éš¾é“æ˜¯å¹³å°çš„ bug ?ä¸è§£çš„å°éƒ‘æ‰“ç®—å‘ç¨‹åºå‘˜æœ‹å‹å°ç›–è¯¢é—®ï¼Œå°ç›–ä¸€çœ‹ï¼š")]),s._v(" "),t("p",[s._v("ã€Œ è¿™åº”è¯¥æ˜¯ç”¨äº† toFixed äº†å§ï¼Œè¿™æ–¹æ³•æœ‰ä¸ªå‘ã€‚ã€‚å®¹æˆ‘ç»†ç»†é“æ¥ ã€")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»¥ä¸Šæ•…äº‹çº¯å±è™šæ„ï¼ˆåŒ…æ‹¬å›¾ç‰‡ï¼‰")])]),s._v(" "),t("h2",{attrs:{id:"tofixed-æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tofixed-æ˜¯ä»€ä¹ˆ"}},[s._v("#")]),s._v(" toFixed æ˜¯ä»€ä¹ˆ")]),s._v(" "),t("p",[s._v("ä»¥ä¸‹å¼•è‡ª "),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed",target:"_blank",rel:"noopener noreferrer"}},[s._v("MDN"),t("OutboundLink")],1),s._v(" çš„å®šä¹‰")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("numObj.toFixed(digits)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("è¿”å›æŒ‡å®š digits ä½æ•°çš„å­—ç¬¦ä¸²ï¼Œå¿…è¦æ—¶ä¼šè¿›è¡Œå››èˆäº”å…¥ã€‚çœ‹ä»¥ä¸‹ä¾‹å­")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.45")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toFixed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "99.5"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.99")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toFixed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "100.0"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toFixed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "99.5" warning: è§ä¸‹é¢è§£é‡Š')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("æ˜¯ä¸æ˜¯å‘ç°ç¬¬ä¸‰ä¸ªä¾‹å­ä¸å¤ªå¯¹ï¼Ÿ")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬çŸ¥é“ï¼Œjs ä¸­çš„æµ®ç‚¹æ•°å†…éƒ¨æ˜¯ç”¨åŒç²¾åº¦ 64ä½ï¼ˆdoubleï¼‰è¡¨ç¤ºçš„ï¼Œé‡‡ç”¨çš„æ˜¯ "),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/IEEE_754",target:"_blank",rel:"noopener noreferrer"}},[s._v("IEEE 754 è¡¨ç¤ºæ³•"),t("OutboundLink")],1),s._v("ï¼Œ")]),s._v(" "),t("p",[s._v("æ‰€ä»¥ "),t("code",[s._v("99.55")]),s._v(" å®é™…æ˜¯ "),t("code",[s._v("99.549999999999997")])]),s._v(" "),t("blockquote",[t("p",[s._v("ç½‘ä¸Šæœ‰"),t("a",{attrs:{href:"https://www.binaryconvert.com/convert_double.html?decimal=057057046053053",target:"_blank",rel:"noopener noreferrer"}},[s._v("åœ¨çº¿å·¥å…·"),t("OutboundLink")],1),s._v("å¯ä»¥ç›´æ¥ç®—å‡ºæ¥")])]),s._v(" "),t("p",[s._v("é‚£ä¹ˆå¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ¥ç­”æ¡ˆï¼Œå››èˆäº”å…¥ç»“æœå°±æ˜¯ "),t("code",[s._v("99.5")])]),s._v(" "),t("p",[s._v("soï¼Œå¾—åˆ°ç­”æ¡ˆäº†ï¼Œæœ¬æ–‡ç»“æŸ?")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬å†çœ‹ä¸‹ ecmascript è§„èŒƒæ˜¯æ€ä¹ˆæè¿°çš„")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://www.ecma-international.org/ecma-262/6.0/#sec-number.prototype.tofixed",target:"_blank",rel:"noopener noreferrer"}},[s._v("Number.prototype.toFixed ( fractionDigits )"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/9277731-b6ba435aed1e5c67.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"toFixed"}})]),s._v(" "),t("p",[s._v("å…³é”®çœ‹çº¢è‰²åŒºåŸŸï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸ªä¸€ä¸ª n ï¼Œä½¿å…¶ "),t("code",[s._v("n / 10 - 99.55")]),s._v(" å°½å¯èƒ½æ¥è¿‘é›¶ã€‚ æ‰¾åˆ° n ä¹‹ååé¢çš„ç»“æœå°±éƒ½ç¡®å®šäº†ã€‚")]),s._v(" "),t("p",[s._v("ï¼ˆé¢ï¼Œçœ‹èµ·æ¥å¥½åƒå¾ˆå¤æ‚çš„æ ·å­ï¼Œä¸æ˜¯ç›´æ¥å¯¹å°æ•°ä½å››èˆäº”å…¥ã€‚ã€‚ï¼‰")]),s._v(" "),t("p",[s._v('å‡è®¾ n ä¸º 995,åˆ™ m ä¸º "995", k = m.length = 3, a = "99", b = "5", æœ€ç»ˆç»“æœä¸º "99.5"')]),s._v(" "),t("p",[s._v("é‚£ä¹ˆ n æ˜¯ä¸æ˜¯ 995 å‘¢ï¼Ÿ")]),s._v(" "),t("p",[s._v("æ»¡è¶³ "),t("code",[s._v("n / 10 - 99.55")]),s._v(" å°½å¯èƒ½æ¥è¿‘é›¶è¿™ä¸ªæ¡ä»¶çš„æœ‰ä¸¤ä¸ªæ•°ï¼š 995,996 è€Œä»–ä»¬çš„è®¡ç®—ç»“æœåˆ†åˆ«ä¸ºï¼š")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("995")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -0.04999999999999716")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("996")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  0.04999999999999716")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("å’Œ 0 é—´çš„å·®å€¼æ˜¯ä¸€æ ·çš„ï¼Œé€‰å¤§çš„ç»“æœæ˜¯ 996 ï¼Œå¯æˆ‘ä»¬è¿è¡Œçš„ç»“æœå´æ˜¯ 99.5 ï¼Œè¿™åˆæ˜¯ä¸ºä½•ï¼Ÿéš¾é“æµè§ˆå™¨å¼•æ“çš„å®ç°æœ‰è¯¯ï¼Ÿæˆ–è€…æ²¡æŒ‰è§„èŒƒå®ç°ï¼Ÿ")]),s._v(" "),t("p",[s._v("å¯¹æ¯”äº†å‡ ä¸ªå¼•æ“ï¼Œç»“æœéƒ½æ˜¯ 995ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€å“ˆ JavaScriptCore (Webkit çš„ js å¼•æ“) å®ç°")]),s._v(" "),t("h2",{attrs:{id:"javascriptcore-tofixed-æºç "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascriptcore-tofixed-æºç "}},[s._v("#")]),s._v(" JavaScriptCore toFixed æºç ")]),s._v(" "),t("p",[s._v("æºç åœ¨ "),t("code",[s._v("webkit/Source/JavaScriptCore/runtime/NumberPrototype.cpp")]),s._v(" ä¸­çš„ numberProtoFuncToFixed æ–¹æ³•")]),s._v(" "),t("p",[s._v("åœ¨ JavaScriptCore ä¸­ï¼ŒåŸå‹æ–¹æ³•å¾ˆå¥½æ‰¾ï¼Œå°±æ˜¯ xxxProtoFuncXxx çš„ç»“æ„")]),s._v(" "),t("h3",{attrs:{id:"è°ƒè¯•ç¯å¢ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è°ƒè¯•ç¯å¢ƒ"}},[s._v("#")]),s._v(" è°ƒè¯•ç¯å¢ƒ")]),s._v(" "),t("p",[s._v("ï¼ˆæœ¬å°ç»“å¯ä»¥é€‰æ‹©ç•¥è¿‡ï¼Œç›´æ¥çœ‹åé¢çš„åˆ†æå’Œå°ç»“ï¼‰")]),s._v(" "),t("p",[s._v("åœ¨ macOS ä¸Šç¼–è¯‘ webkit æ¯” v8 ç®€å•å¤šäº†ï¼Œè¯¦è§ "),t("a",{attrs:{href:"https://liveoverflow.com/setup-and-debug-javascriptcore-webkit-browser-0x01/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Setup and Debug JavaScriptCore / WebKit"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›å…¥ debug ç¯å¢ƒ")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ©ç”¨ lldb è°ƒè¯• jsc")]),s._v("\n$ lldb ./WebKitBuild/Debug/bin/jsc\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¼€å§‹è°ƒè¯•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lldb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" run\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# control + c å†æ¬¡è¿›å…¥ lldb")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ‰“æ–­ç‚¹, æ–­ç‚¹æ–¹æ³•è¾“å‡ ä¸ªå­—ç¬¦æŒ‰ Tab å°±å¯ä»¥å‡ºæç¤ºäº†")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lldb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": b JSC::numberProtoFuncToFixed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("JSC::JSGlobalObject*, JSC::CallFrame*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lldb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": b WTF::double_conversion::FastFixedDtoa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("double, int, WTF::double_conversion::BufferReference"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("char"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", int*, int*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç»“æŸè°ƒè¯•ï¼Œåˆ‡åˆ° jsc, éœ€è¦æŒ‰ 2æ¬¡å›è½¦")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lldb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": c\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¾“å…¥ js ä»£ç ï¼Œå›è½¦è¿›å…¥ lldb è°ƒè¯•ç¯å¢ƒ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),s._v(".toFixed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# EncodedJSValue JSC_HOST_CALL numberProtoFuncToFixed(JSGlobalObject* globalObject, CallFrame* callFrame)")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("jsc å¸¸ç”¨æŒ‡ä»¤")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("describe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æŸ¥çœ‹å¯¹è±¡ï¼ˆjsåœ¨ c ä¸­å‡ä¸ºå¯¹è±¡ï¼‰ çš„å†…éƒ¨æè¿°ï¼Œç»“æ„ï¼Œå†…å­˜åœ°å€")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("lldb å¸¸ç”¨æŒ‡ä»¤")]),s._v(" "),t("blockquote",[t("p",[s._v("å¢å¼ºæ’ä»¶ chisel ï¼Œæ›´å¤šä½¿ç”¨æ–¹æ³•åç»­å†™ä¸€ç¯‡æ–‡ç« ï¼Œ")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("x/8gx address "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æŸ¥çœ‹å†…å­˜åœ°å€ address")]),s._v("\n\nnext"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å•æ­¥æ‰§è¡Œ")]),s._v("\nstep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#è¿›å…¥å‡½æ•°")]),s._v("\ncontinue"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å°†ç¨‹åºè¿è¡Œåˆ°ç»“æŸæˆ–è€…æ–­ç‚¹å¤„ï¼ˆè¿›å…¥ä¸‹ä¸€æ–­ç‚¹ï¼‰")]),s._v("\nfinish "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å°†ç¨‹åºè¿è¡Œåˆ°å½“å‰å‡½æ•°è¿”å›ï¼ˆä»å‡½æ•°è·³å‡ºï¼‰")]),s._v("\nbreakpoint"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" è¡Œå·/å‡½æ•°å "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("æ¡ä»¶è¯­å¥"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#è®¾ç½®æ–­ç‚¹")]),s._v("\nfr "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æŸ¥çœ‹å±€éƒ¨å˜é‡ä¿¡æ¯")]),s._v("\nprint"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#è¾“å‡ºå˜é‡ x çš„å€¼")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"æºç åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æºç åˆ†æ"}},[s._v("#")]),s._v(" æºç åˆ†æ")]),s._v(" "),t("p",[s._v("å…¥å£ï¼Œå„ç§æƒ…å†µçš„å¤„ç†")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("EncodedJSValue JSC_HOST_CALL "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("numberProtoFuncToFixed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("JSGlobalObject"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" globalObject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CallFrame"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" callFrame"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    VM"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" vm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" globalObject"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vm")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auto")]),s._v(" scope "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("DECLARE_THROW_SCOPE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// x å–å€¼ 99.549999999999997")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("double")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toThisNumber")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" callFrame"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("thisValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("throwVMToThisNumberError")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("globalObject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" scope"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" callFrame"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("thisValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// decimalPlaces å–å€¼ 1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" decimalPlaces "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" static_cast"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("callFrame"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("argument")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toInteger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("globalObject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RETURN_IF_EXCEPTION")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("scope"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç‰¹æ®Šå¤„ç†ï¼Œç•¥")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("decimalPlaces "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" decimalPlaces "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("throwVMRangeError")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("globalObject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" scope"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"toFixed() argument must be between 0 and 100"')]),s._v("_s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// x çš„ç‰¹æ®Šå¤„ç†ï¼Œç•¥")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fabs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+21")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" JSValue"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("encode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("jsString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" String"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// NaN or Infinity çš„ç‰¹æ®Šå¤„ç†")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ASSERT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isfinite")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¿›å…¥æ‰§è¡Œ number=99.549999999999997, decimalPlaces=1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" JSValue"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("encode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("jsString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" String"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("numberToStringFixedWidth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" decimalPlaces"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("p",[s._v("ä» numberToStringFixedWidth æ–¹æ³•ä¸æ–­è¿›å…¥ï¼Œåˆ°è¾¾ FastFixedDtoa å¤„ç†æ–¹æ³•")]),s._v(" "),t("p",[s._v("éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŸæ•°å€¼çš„æ•´æ•°å’Œå°æ•°éƒ¨åˆ†éƒ½åˆ†åˆ«é‡‡ç”¨äº†æŒ‡æ•°è¡¨ç¤ºæ³•ï¼Œæ–¹ä¾¿åé¢ä½è¿ç®—å¤„ç†")]),s._v(" "),t("p",[t("code",[s._v("99.549999999999997 = 7005208482886451 * 2 ** -46 = 99 + 38702809297715 * 2 ** -46")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// FastFixedDtoa(v=99.549999999999997, fractional_count=1, buffer=(start_ = "", length_ = 122), length=0x00007ffeefbfd488, decimal_point=0x00007ffeefbfd494)')]),s._v("\n\nbool "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("FastFixedDtoa")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("double v"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                   int fractional_count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                   BufferReference"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("char"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                   int"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                   int"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" decimal_point")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" uint32_t kMaxUInt32 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFFFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°† v è¡¨ç¤ºæˆ å°¾æ•°(significand) Ã— åº•æ•°(2) ^ æŒ‡æ•°(exponent) ")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 7005208482886451 x 2 ^ -46")]),s._v("\n  uint64_t significand "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Double")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Significand")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  int exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Double")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Exponent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// çœç•¥éƒ¨åˆ†ä»£ç ")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" kDoubleSignificandSize "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("kDoubleSignificandSize"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// exponent > -53 çš„æƒ…å†µ, åˆ‡å‰²æ•°å­—")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ•´æ•°éƒ¨åˆ†: integrals = 7005208482886451 >> 46 = 99 ")]),s._v("\n    uint64_t integrals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" significand "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exponent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°æ•°éƒ¨åˆ†(æŒ‡æ•°è¡¨è¾¾æ³•çš„å°¾æ•°éƒ¨åˆ†): fractionals = 7005208482886451 - 99 << 46  = 38702809297715")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŒ‡æ•°ä¸å˜ -46")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 38702809297715 * (2 ** -46) = 0.5499999999999972")]),s._v("\n    uint64_t fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" significand "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integrals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exponent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integrals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kMaxUInt32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("FillDigits64")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integrals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// buffer ä¸­æ”¾å…¥ "99"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("FillDigits32")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("static_cast"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("uint32_t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integrals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("decimal_point "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// å¡«å……å°æ•°éƒ¨åˆ†ï¼Œbuffer ä¸º "995"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("FillFractionals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" exponent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fractional_count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" decimal_point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TrimZeros")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" decimal_point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// The string is empty and the decimal_point thus has no importance. Mimick")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Gay's dtoa and and set it to -fractional_count.")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("decimal_point "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fractional_count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br")])]),t("p",[s._v("FillFractionals ç”¨æ¥å¡«å……å°æ•°éƒ¨åˆ†ï¼Œå–å‡ ä½ï¼Œæ˜¯å¦è¿›ä½éƒ½åœ¨è¯¥æ–¹æ³•ä¸­å¤„ç†")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// FillFractionals(fractionals=38702809297715, exponent=-46, fractional_count=1, buffer=(start_ = "99ï¿½ï¿½ï¿½", length_ = 122), length=0x00007ffeefbfd488, decimal_point=0x00007ffeefbfd494)')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\nå°æ•°éƒ¨åˆ†çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ï¼š fractionals * 2 ^ -exponent\n38702809297715 * (2 ** -46) = 0.5499999999999972\n\nå‰æï¼š\n  -128 <= exponent <=0ã€‚\n  0 <= fractionals * 2 ^ exponent < 1 \n  buffer å¯ä»¥ä¿å­˜ç»“æœ\næ­¤å‡½æ•°å°†èˆå…¥ç»“æœã€‚åœ¨èˆå…¥è¿‡ç¨‹ä¸­ï¼Œæ­¤å‡½æ•°æœªç”Ÿæˆçš„æ•°å­—å¯èƒ½ä¼šæ›´æ–°ï¼Œä¸”å°æ•°ç‚¹å˜é‡å¯èƒ½ä¼šæ›´æ–°ã€‚å¦‚æœæ­¤å‡½æ•°ç”Ÿæˆæ•°å­— 99ï¼Œå¹¶ä¸”ç¼“å†²åŒºå·²ç»åŒ…å« â€œ199â€ï¼ˆå› æ­¤äº§ç”Ÿçš„ç¼“å†²åŒºä¸ºâ€œ19999â€ï¼‰ï¼Œåˆ™å‘ä¸Šèˆå…¥ä¼šå°†ç¼“å†²åŒºçš„å†…å®¹æ›´æ”¹ä¸º â€œ20000â€ã€‚\n*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("FillFractionals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint64_t")]),s._v(" fractionals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" exponent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" fractional_count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BufferReference"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" decimal_point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ASSERT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exponent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ASSERT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" point "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exponent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 46")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¯æ¬¡è¿­ä»£ï¼Œå°†å°æ•°ä¹˜ä»¥10ï¼Œå»é™¤æ•´æ•°éƒ¨åˆ†æ”¾å…¥ buffer")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" fractional_count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0->1")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// fractionals ä¹˜ä»¥ 5 è€Œä¸æ˜¯ä¹˜ä»¥ 10 ï¼Œå¹¶è°ƒæ•´ point çš„ä½ç½®ï¼Œè¿™æ ·ï¼Œ fractionals å˜é‡å°†ä¸ä¼šæº¢å‡ºã€‚ç„¶åæ•´ä½“ç›¸å½“äºä¹˜ä»¥ 10")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸ä¼šæº¢å‡ºçš„éªŒè¯è¿‡ç¨‹ï¼š")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¾ªç¯åˆå§‹ï¼š fractionals < 2 ^ point , point <= 64 ä¸” fractionals < 2 ^ 56")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¯æ¬¡è¿­ä»£åï¼Œ point-- ã€‚")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ³¨æ„ 5 ^ 3 = 125 < 128 = 2 ^ 7ã€‚")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å› æ­¤ï¼Œæ­¤å¾ªç¯çš„ä¸‰ä¸ªè¿­ä»£ä¸ä¼šæº¢å‡º fractionals ï¼ˆå³ä½¿åœ¨å¾ªç¯ä½“æœ«å°¾æ²¡æœ‰å‡æ³•ï¼‰ã€‚")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸æ­¤åŒæ—¶ point å°†æ»¡è¶³ point <= 61ï¼Œå› æ­¤ fractionals < 2 ^ point ï¼Œå¹¶ä¸” fractionals å†ä¹˜ä»¥ 5 å°†ä¸ä¼šæº¢å‡º(<int64)ã€‚")]),s._v("\n\n\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯¥æ“ä½œä¸ä¼šæº¢å‡ºï¼Œè¯æ˜è§ä¸Šæ–¹")]),s._v("\n      fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 193514046488575")]),s._v("\n      point"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 45")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" digit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" static_cast"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 193514046488575 * 2 ** -45 = 5")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ASSERT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("digit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" static_cast"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'0'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" digit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// '995'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å»æ‰æ•´æ•°ä½")]),s._v("\n      fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-=")]),s._v(" static_cast"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint64_t")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("digit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 193514046488575 - 5 * 2 ** 45 = 17592186044415 ")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 17592186044415 * 2 ** -45 = 0.4999999999999716 ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// çœ‹å°æ•°çš„ä¸‹ä¸€ä½æ˜¯å¦å€¼å¾—è®© buffer ä¸­å…ƒç´ è¿›ä½")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é€šè¿‡ä¹˜2çœ‹æ˜¯å¦èƒ½ >=1 æ¥åˆ¤æ–­")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ASSERT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" point "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æœ¬ä¾‹ä¸­ 17592186044415 >> 44 = 17592186044415 * 2 ** -44 = 0.9999999999999432 , & 1 = 0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fractionals "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("point "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RoundUp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" decimal_point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// We need 128 bits.")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br")])]),t("p",[s._v("è¿™æ ·å°±å¾—åˆ°äº† 995 ï¼Œå³è§„èŒƒæè¿°ä¸­çš„ n ï¼Œåé¢æ’å…¥ä¸€ä¸ªå°æ•°ç‚¹å³ä¸ºæœ€ç»ˆç»“æœ 99.5")]),s._v(" "),t("h3",{attrs:{id:"å°ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“"}},[s._v("#")]),s._v(" å°ç»“")]),s._v(" "),t("p",[s._v("js å¼•æ“å¹¶æ²¡æœ‰æŒ‰è§„èŒƒä¸­è¯´çš„ï¼Œå»å¯»æ‰¾ä¸€ä¸ª n ï¼Œä½¿å…¶ "),t("code",[s._v("n / (10 ^ f)")]),s._v(" å°½å¯èƒ½ç­‰äº x ï¼Œæ„Ÿè§‰è¿™æ ·æ•ˆç‡å¤ªæ…¢äº†ã€‚è€Œæ˜¯ç›´æ¥å°† x åˆ†ä¸ºæ•´æ•°å’Œå°æ•°éƒ¨åˆ†ï¼Œå¹¶é‡‡ç”¨æŒ‡æ•°è¡¨ç¤ºæ³•åˆ†åˆ«è¿›è¡Œè®¡ç®—ã€‚")]),s._v(" "),t("p",[s._v("å¤„ç†å°æ•°çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯è®©å°æ•°ç‚¹å³ç§»ã€‚ç”¨æŒ‡æ•°è¡¨ç¤ºæ³•çš„æ—¶å€™ï¼Œå…¶ä¸­æœ‰ä¸ªç»†èŠ‚å°±æ˜¯è€ƒè™‘äº†åº•æ•°ç›´æ¥ "),t("code",[s._v("*10")]),s._v(" å¯èƒ½ä¼šå¯¼è‡´æº¢å‡ºï¼Œç„¶åé‡‡ç”¨äº† "),t("code",[s._v("åº•æ•° *5 ï¼ŒæŒ‡æ•°é€’å‡")]),s._v(" çš„æ–¹å¼ ï¼Œæ³¨é‡Šä¸­ç»™å‡ºäº†è¯æ˜ã€‚ åœ¨ f ä½è®¡ç®—åï¼Œæœ€åå†è®¡ç®—ä¸‹ä¸€ä½ï¼Œçœ‹æ˜¯å¦éœ€è¦è¿›ä½ã€‚")]),s._v(" "),t("p",[s._v("å½“ç„¶ï¼Œæœ€ç»ˆç»“æœä¸ç¬¦åˆæˆ‘ä»¬æ—¥å¸¸çš„è®¡ç®—ï¼Œæ ¸å¿ƒè¿˜æ˜¯åœ¨äº IEEE 754 è¡¨ç¤ºæ³•")]),s._v(" "),t("p",[s._v("99.55 åœ¨è°ƒè¯•åˆæœŸå–å€¼å°±æ˜¯ 99.549999999999997 äº†")]),s._v(" "),t("p",[s._v("å› æ­¤ï¼Œä»¥åç”¨ toFixed æ–¹æ³•çš„æ—¶å€™ï¼Œè¦æ˜¯æ‹…å¿ƒæ²¡æœ‰æ­£å¸¸å››èˆäº”å…¥ï¼Œå°±å…ˆå» "),t("a",{attrs:{href:"https://www.binaryconvert.com/convert_double.html?decimal=057057046053053",target:"_blank",rel:"noopener noreferrer"}},[s._v("åœ¨çº¿å·¥å…·"),t("OutboundLink")],1),s._v(" ä¸ŠæŸ¥çœ‹çœ‹")]),s._v(" "),t("h2",{attrs:{id:"v8-tofixed-æºç "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#v8-tofixed-æºç "}},[s._v("#")]),s._v(" V8 toFixed æºç ")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://source.chromium.org/chromium/chromium/src/+/master:v8/src/builtins/builtins-number.cc;l=67?q=NumberPrototypeToFixed&ss=chromium%2Fchromium%2Fsrc:v8%2F",target:"_blank",rel:"noopener noreferrer"}},[s._v("v8 toFixed"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("å…¥å£åœ¨è¿™ï¼Œå°±ä¸å†åˆ†æäº†ï¼Œå’Œ JavaScriptCore å¤§åŒå°å¼‚ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ES6 section 20.1.3.3 Number.prototype.toFixed ( fractionDigits )")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("BUILTIN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NumberPrototypeToFixed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ... çœç•¥å‚æ•°è§£æï¼Œæ‹†åŒ…ï¼Œç±»å‹åˆ¤æ–­")]),s._v("\n  \n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// value_number å’Œ fraction_digits_number å³ä¸ºæˆ‘ä»¬ç›®æ ‡å€¼")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‡è®¾ value_number = 99.55, fraction_digits_number = 1.0")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("double")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" value_number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("double")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fraction_digits_number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fraction_digits"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ... çœç•¥èŒƒå›´æ£€æŸ¥")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ... çœç•¥ value_number ç‰¹æ®Šå€¼å¤„ç†ï¼š Infinity NaN")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®é™…å¤„ç†æ–¹æ³• DoubleToFixedCString")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" str "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("DoubleToFixedCString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      value_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" static_cast"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fraction_digits_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  Handle"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("String"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" isolate"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("factory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewStringFromAsciiChecked")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("str"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("DeleteArray")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("str"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("h2",{attrs:{id:"æ­£ç¡®çš„-ã€Œå››èˆäº”å…¥ã€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­£ç¡®çš„-ã€Œå››èˆäº”å…¥ã€"}},[s._v("#")]),s._v(" æ­£ç¡®çš„ ã€Œå››èˆäº”å…¥ã€")]),s._v(" "),t("p",[s._v("é‚£å¦‚ä½•å†™å‡ºä¸€ä¸ªç¬¦åˆå¸¸ç†çš„å››èˆäº”å…¥æ–¹æ³•å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å€ŸåŠ© "),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math/round",target:"_blank",rel:"noopener noreferrer"}},[s._v("Math.round"),t("OutboundLink")],1),s._v(" æ–¹æ³•å®ç°")]),s._v(" "),t("h3",{attrs:{id:"math-round-x"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#math-round-x"}},[s._v("#")]),s._v(" Math.round(x)")]),s._v(" "),t("p",[s._v("ç»™å®šæ•°å­—çš„å€¼ x å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚")]),s._v(" "),t("ul",[t("li",[s._v("å¦‚æœ x çš„å°æ•°éƒ¨åˆ†å¤§äº 0.5ï¼Œåˆ™èˆå…¥åˆ°ç›¸é‚»çš„ç»å¯¹å€¼æ›´å¤§çš„æ•´æ•°ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœ x çš„å°æ•°éƒ¨åˆ†å°äº 0.5ï¼Œåˆ™èˆå…¥åˆ°ç›¸é‚»çš„ç»å¯¹å€¼æ›´å°çš„æ•´æ•°ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœå‚æ•°çš„å°æ•°éƒ¨åˆ†æ°å¥½ç­‰äº0.5ï¼Œåˆ™èˆå…¥åˆ°ç›¸é‚»çš„åœ¨æ­£æ— ç©·ï¼ˆ+âˆï¼‰æ–¹å‘ä¸Šçš„æ•´æ•°ã€‚\n"),t("blockquote",[t("p",[s._v("âš ï¸ æ³¨æ„ï¼š ä¸å¾ˆå¤šå…¶ä»–è¯­è¨€ä¸­çš„round()å‡½æ•°ä¸åŒï¼ŒMath.round()å¹¶ä¸æ€»æ˜¯èˆå…¥åˆ°è¿œç¦»0çš„æ–¹å‘ï¼ˆå°¤å…¶æ˜¯åœ¨è´Ÿæ•°çš„å°æ•°éƒ¨åˆ†æ°å¥½ç­‰äº0.5çš„æƒ…å†µä¸‹ï¼‰ã€‚")])])])]),s._v(" "),t("p",[s._v("ä¸¾ä¾‹")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.51")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 100")]),s._v("\nMath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 100")]),s._v("\nMath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.49")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//99")]),s._v("\nMath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.51")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -100")]),s._v("\nMath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -99")]),s._v("\nMath"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.49")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//-99 ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"ä»£ç "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç "}},[s._v("#")]),s._v(" ä»£ç ")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ³¨æ„ï¼Œè¦ç”¨é™¤æ³•ã€‚è‹¥ç”¨ä¹˜æ³•çš„è¯ï¼Œä¹˜ä»¥å°æ•°ï¼Œè¯¥å°æ•°æ˜¯ä¸ç²¾ç¡®çš„ ï¼ˆè¿˜æ˜¯ä¸Šé¢çš„åŸå› ï¼Œieee 754 è¡¨ç¤ºæ³•ï¼‰")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 996 * 0.1 = 99.60000000000001")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'e'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//same as:")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//return Number(Math.round(+number + 'e' + precision) + 'e-' + precision);")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 99.6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -99")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("å¯¹è´Ÿæ•°è¿›è¡Œï¼Œæ¯”å¦‚ -99.5 å››èˆäº”å…¥æŒ‰å…¶ä»–å¹³å°å¤„ç†ï¼Œå–å€¼ -100")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * \n * @param {*} number \n * @param {*} precision \n * @param {boolean} flag è´Ÿæ•°å››èˆäº”å…¥æ˜¯å¦æŒ‰è¿œç¦» 0 å¤„ç†\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" flag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("abs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'e'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 99.6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -99.5")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99.55")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -99.6")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("ä¹‹å‰æƒ³è¯´è¿˜éœ€è¦è€ƒè™‘æº¢å‡ºï¼Œå› ä¸ºå‘ç°æˆ‘ä»¬è‡ªå·±å®ç°çš„ round å’Œ toFixed éƒ½ä¸ç¬¦åˆé¢„æœŸ")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("999999999955.2376236232")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 999999999955.2378")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("999999999955.2376236232")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toFixed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "999999999955.237671')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("åæ¥å‘ç° "),t("code",[s._v("999999999955.2376236232")]),s._v(" è¿™ä¸ªæ•°å­—åœ¨ 64 ä½ä¸­å°±æ— æ³•è¡¨ç¤ºäº†ï¼Œåªèƒ½è¡¨ç¤ºä¸º "),t("code",[s._v("9.999999999552376708984375e11")])]),s._v(" "),t("p",[s._v("æ‰€ä»¥ï¼Œæº¢å‡ºçš„ä¾‹å­æˆ‘ä»¬å°±ä¸è€ƒè™‘äº†ã€‚")]),s._v(" "),t("p",[s._v("PS: å¤„ç†æ—¶å‘ç°çš„ä¸€ä¸ªæ–¹æ³• "),t("code",[s._v("Math.trunc")]),s._v(" å¯ä»¥ç›´æ¥æ‹¿åˆ°æ•´æ•°éƒ¨åˆ†ï¼Œä¸ç®¡æ­£è´Ÿï¼Œä¸åƒ "),t("code",[s._v("Math.floor")]),s._v(" å¯¹äºè´Ÿæ•°ä¼šå‘ä¸‹å–æ•´")]),s._v(" "),t("h3",{attrs:{id:"å›åˆ°é—®é¢˜-å¹³å°å¦‚ä½•ä¿®å¤è¿™ä¸ªbug"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å›åˆ°é—®é¢˜-å¹³å°å¦‚ä½•ä¿®å¤è¿™ä¸ªbug"}},[s._v("#")]),s._v(" å›åˆ°é—®é¢˜ï¼Œå¹³å°å¦‚ä½•ä¿®å¤è¿™ä¸ªbug")]),s._v(" "),t("p",[s._v("å¹³å°ä¸Šçš„ç²‰ä¸æ•°æ˜¾ç¤ºéµä»è¿™æ ·å‡ ä¸ªåŸåˆ™ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("å°äº 1 ä¸‡ï¼Œç›´æ¥æ˜¾ç¤º")]),s._v(" "),t("li",[s._v("å°äº 1 äº¿ï¼Œå››èˆäº”å…¥ä¿ç•™ä¸€ä½å°æ•°ï¼Œè‹¥å°æ•°éƒ¨åˆ†ä¸º 0 ï¼Œåˆ™ä¸æ˜¾ç¤º")]),s._v(" "),t("li",[s._v("å¤§äºç­‰äº 1 äº¿ï¼Œå››èˆäº”å…¥ä¿ç•™ä¸€ä½å°æ•°ï¼Œè‹¥å°æ•°éƒ¨åˆ†ä¸º 0 ï¼Œåˆ™ä¸æ˜¾ç¤º")])]),s._v(" "),t("p",[s._v("åˆ©ç”¨åˆšåˆšå†™çš„ round å‡½æ•°æ“ä½œä¸€æ³¢")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" flag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("abs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'e'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("formatNumForAvatar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("num")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("unit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'äº¿'")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("unit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ä¸‡"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" num\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * æµ‹è¯•ç”¨ä¾‹\n */")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// {num: 9999}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99999")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 10, unit: "ä¸‡"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("995500")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 99.6, unit: "ä¸‡"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99999900")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 10000, unit: "ä¸‡"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109999900")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 1.1, unit: "äº¿"}')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br")])]),t("p",[s._v("è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œæ²¡æœ‰å¤„ç†å¥½ "),t("code",[s._v("10000 ä¸‡")]),s._v(" è¿™ç§ case")]),s._v(" "),t("p",[s._v("ç›®å‰æƒ³åˆ°çš„å°±æ˜¯å¢åŠ åˆ¤æ–­æ¡ä»¶ï¼Œæˆ–è€…ç¡¬ç¼–ç ")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" flag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("abs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'e'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v(" precision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("formatNumForAvatar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("num")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç† 99995000+ çš„æƒ…å†µ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+8")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("unit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'äº¿'")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("round")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e+4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("unit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ä¸‡"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("num")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" num\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * æµ‹è¯•ç”¨ä¾‹\n */")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// {num: 9999}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99999")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 10, unit: "ä¸‡"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("995500")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 99.6, unit: "ä¸‡"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99994999")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 9999.5, unit: "ä¸‡"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99999900")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 1, unit: "äº¿"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatNumForAvatar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109999900")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// {num: 1.1, unit: "äº¿"}')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("p",[s._v("å¦‚æœæœ‰å…¶ä»–æ›´å¥½çš„æ–¹å¼æ¬¢è¿è¯„è®º~")]),s._v(" "),t("h2",{attrs:{id:"æœ€å"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æœ€å"}},[s._v("#")]),s._v(" æœ€å")]),s._v(" "),t("p",[s._v("ä»å‘ç°é—®é¢˜ï¼Œåˆ°å†™ä¸‹è¿™ç¯‡æ–‡ç« æ‹–äº†å¤§æ¦‚ 2 å‘¨äº†ï¼Œä¸»è¦æ˜¯ä¹‹å‰å¯¹ JS å¼•æ“è°ƒè¯•å®Œå…¨ä¸äº†è§£")]),s._v(" "),t("p",[s._v("å…‰æ­å»º v8 è°ƒè¯•ç¯å¢ƒå°±èŠ±äº†å¥½å‡ ä¸ªæ™šä¸Šï¼ŒåŒ…æ‹¬ macOS ä¸Š gdb çš„å‘ï¼ŒV8 æ„å»ºçš„å‘ï¼Œæ–­ç‚¹è°ƒè¯•çš„å‘ï¼Œå¦‚ä½•é…åˆ vscode ç­‰ç­‰... åé¢ä¼šå†å‡ºå‡ ç¯‡æ–‡ç« è®²è¿™ä¸ªï¼Œæ¬¢è¿å…³æ³¨")]),s._v(" "),t("p",[s._v("å¦‚æœæ˜¯ macOS ä¸Šï¼Œå»ºè®®è¿˜æ˜¯å»çœ‹ JavaScriptCore æºç å§ï¼Œè¿™äº›åŸºç¡€æ–¹æ³•å®ç°ï¼Œå…¶å®å¤§éƒ¨åˆ†å’Œ V8 æ˜¯ä¸€æ ·çš„")]),s._v(" "),t("h2",{attrs:{id:"å‚è€ƒæ–‡æ¡£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡æ¡£"}},[s._v("#")]),s._v(" å‚è€ƒæ–‡æ¡£")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://liveoverflow.com/setup-and-debug-javascriptcore-webkit-browser-0x01/",target:"_blank",rel:"noopener noreferrer"}},[s._v("JavaScriptCore ç¼–è¯‘è°ƒè¯•"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/26144355",target:"_blank",rel:"noopener noreferrer"}},[s._v("è°ƒè¯• WebKit"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);